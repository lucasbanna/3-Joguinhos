#include <stdio.h>
#include <stdlib.h>
#include <locale.h>
#include <unistd.h>

//gepeto me ajudou daqui...

#define RESET   "\x1B[0m"
#define RED     "\x1B[31m"
#define BLUE    "\x1B[34m"
#define CYAN 	"\e[0;96m"
#define MAGENTA "\x1B[35m"
#define BEGE 	"\033[38;5;138m"
#define YELLOW  "\x1B[33m"

void typeText(const char *text, int delay) {												
    while (*text) {
        putchar(*text++);
        fflush(stdout);  // Garante que o texto apareça imediatamente
        usleep(delay * 1000);  // Converte milissegundos para microssegundos
    }
}
//... até aqui.

int gp();
int tutorial3();
int lore3();
int menu3();
int lixo;

int jogo3() {

	setlocale(LC_ALL,"");
	return menu3();
		
}

int menu3 (){
	
	int opcao;
    do {
    	system("cls");
    	typeText(BEGE "========================\n" RESET, 10);
        typeText(BLUE "GRIMÓRIOS " RESET YELLOW"& " RESET RED "PERGAMINHOS\n\n" RESET, 50);
        typeText("1 - Iniciar Batalha \n", 20);
        typeText("2 - Como Jogar \n", 20);
        typeText("3 - História \n", 20);
        typeText("4 - Sair\n", 20);
  		typeText(BEGE "========================\n" RESET, 10);
        typeText(YELLOW "Escolha uma opção: " RESET, 100);
        scanf("%d", &opcao);
        fflush(stdin);

		if (opcao == 1 || opcao == 2 || opcao == 3 || opcao == 4){
		
        	switch (opcao) {
        		    case 1:
        		        gp();
        	        break;
        		    case 2:
        		        tutorial3();
        	        break;
        		    case 3:
        		        lore3();
        	        break;
        		    case 4:
        		        printf("Saindo...\n");
        		        return 0;
        		    default:
        		       	system("cls");
        		        printf("Opção inválida. Tente novamente.\n");
        	}
		}
 	   else if (opcao != (opcao >=1 && opcao <= 4 )){ 
			printf(YELLOW "Opção inválida. Insira qualquer valor inteiro para continuar.\n" RESET);
			scanf("%d", &lixo);
			continue;
		}
        
    } while (opcao != 4);
    return 0;
	
	
	
}









int tutorial3() {
	return 0;
}

int lore3 () {
	return 0;
}


int gp(){
	
    
    int ordem; 
    
    do{
    
	int j1[2] = {1,1}; // MAOS DO JOGADOR 1 INICIANDO COM UM DEDO CADA
    int j2[2] = {1,1}; // MAOS DO JOGADOR 2 INICIANDO COM UM DEDO CADA
    
    int maoAttack; // 1 - MAO ESQUERDA 	2 - MAO DIREITA
    int maoDefesa;// 1 - MAO ESQUERDA 	2 - MAO DIREITA
    
    int gamer = 1; // NÚMERO DO JOGADOR QUE ESTÁ NA JOGADA, INICIANDO SEMPRE COM O JOGADOR 1
      
    int acao; // 1-ATACAR 2-SOCORRER
    
    int egua;
    
    int conf;
    
    //========================================ANIMAÇÃO DO INÍCIO
    system("cls");
	printf("Grimórios_&_Pergaminhos versão 0.alguma coisa\n\n");
	typeText(YELLOW "TURNO DOS " RESET RED "FEITICEIROS!\n\n" RESET, 5);
    
	typeText(BEGE "======================================================================================================\n" RESET, 1);
		
	typeText(RED"FEITICEIROS:\t\t"RESET, 5);
	
	typeText("Edranyl:" CYAN " 1° Ciclo de Mana\t\t" RESET, 5);
		
	typeText("Alaric:" CYAN " 1° Ciclo de Mana\t\t\n" RESET, 5);
	
	typeText(BEGE "======================================================================================================\n" RESET, 1);
	
	typeText(BLUE "MAGOS:\t\t\t" RESET, 5);

	typeText("Gardel: " CYAN " 1° Ciclo de Mana\t\t" RESET, 5);
	
	typeText("Esdras:" CYAN " 1° Ciclo de Mana \t\t\n" RESET, 5);
	
	typeText(BEGE "======================================================================================================\n\n" RESET, 1);
	
	typeText(YELLOW "JOGADOR 1, QUAL AÇÃO VOCÊ DESEJA EXECUTAR?" RESET, 100);
	typeText(" (1-Atacar 2-Socorrer 0-Sair)\n", 100);
	
	//=================================AQUI COMEÇA O JOGO ==========================================	
	    while ((j1[0] <5 || j1[1] < 5 || j1[0] > 5 || j1 [1] > 5) && (j2[0] < 5 || j2[1] < 5 || j2[0] > 5 || j2[1] > 5)  ) {	
	    	
			system("cls"); // limpar a tela
			
			printf("Grimórios_&_Pergaminhos versão 0.alguma coisa\n\n");
			
			if(gamer == 1){
				printf(YELLOW "TURNO DOS " RESET);
				printf(RED "FEITICEIROS!\n\n" RESET);

			}
			
			else{
				printf(YELLOW "TURNO DOS " RESET);
				printf(BLUE "MAGOS!\n\n" RESET);
				
				
			}
			
			
			printf(BEGE "======================================================================================================\n" RESET);
			printf(RED"FEITICEIROS:\t\t"RESET);
	    	
			if (j1[0] < 5) {
				printf("Edranyl:");
				printf(CYAN " %d° Ciclo de Mana\t\t" RESET, j1[0]);
			} 
			else if (j1[0] > 5){
				j1[0] -= 5;
				printf( "Edranyl:"); 
				printf(CYAN " %d° Ciclo de Mana\t\t" RESET , j1[0]);
			} 
			else {	
				printf(MAGENTA "Edranyl Paralisado\t\t\t" RESET);    	
			}
			//====================================
			if (j1[1] < 5) {
				printf("Alaric:\t");
				printf (CYAN "%d° Ciclo de Mana\t\t\n" RESET, j1[1]);
			}
			else if (j1[1] > 5) {
				j1[1] -= 5;
				printf("Alaric:\t");
				printf(CYAN"%d° Ciclo de Mana\t\t\n" RESET, j1[1]);
			}
			else {
				printf(MAGENTA "Alaric\tParalisado\t\t\n" RESET); 
			}   	
			//===================================
			printf(BEGE "======================================================================================================\n" RESET);
	    	printf(BLUE "MAGOS:\t\t\t" RESET);
	    	
			if (j2[0] < 5) { 
				printf("Gardel:\t");
				printf(CYAN " %d° Ciclo de Mana \t\t" RESET, j2[0]);
			}
	 		else if (j2[0] > 5) {
				j2[0] -= 5;
				printf("Gardel:\t");
				printf(CYAN " %d° Ciclo de Mana(s)\t\t" RESET, j2[0]);
			}
			 else {
			  printf(MAGENTA "Gardel\t Paralisado\t\t\t" RESET);
			}  
			//====================================  	
	    	
			if (j2[1] < 5) { 
				 printf("Esdras:\t"); 
				 printf(CYAN "%d° Ciclo de Mana\t\t\n" RESET, j2[1]);
			}
			else if (j2[1] > 5){
				 	j2[1] -= 5;
				printf("Esdras:\t");
				printf(CYAN "%d° Ciclo de Mana\t\t\n" RESET, j2[1]);
			}
			else {	
			  printf(MAGENTA"Esdras\tParalisado\t\t\n"RESET);
			}  
			//====================================
			printf(BEGE "======================================================================================================\n\n" RESET);
	    	
	    	
	    	// AGUARDA JOGAS INFORMAR A CAO QUE DESEJA EXECUTAR
	    	printf(YELLOW "JOGADOR %d, QUAL AÇÃO VOCÊ DESEJA EXECUTAR?" RESET, gamer);
			printf(" (1-Atacar 2-Socorrer 0-Sair)\n");
	    	scanf("%d", &acao);
	    	fflush(stdin);
		 
			// INFORMA O TIPO DE AÇÃO ESCOLHIDO	PELO JOGADOR E CRIA REGRA DE NEGÓCIOS PARA CADA ACAO
	    	if (acao == 1 ) { // SE ACAO FOR ATACAR
	    		printf(YELLOW"\nVocê escolheu ATACAR\n" RESET);
	    	
	    		printf(YELLOW"\nCom qual dos seus conjuradores você quer atacar? " RESET);
	    		if (gamer == 1) {
					printf("(1-Edranyl 2-Alaric)\n");
				}
				else {
					printf("(1-Gardel 2-Esdras)\n");
				}
	    		scanf("%d", &maoAttack);
	    		int maoAttackcor = maoAttack - 1;
	    			fflush(stdin);
	    			if (maoAttackcor < 0 || maoAttackcor > 1 || (gamer == 1 && j1[maoAttackcor] == 5) || (gamer == 2 && j2[maoAttackcor] == 5)) {
						printf(YELLOW "Personagem inválido! Escolha um conjurador que ainda esteja batalhando.\n\n Insira qualquer valor para continuar. \n" RESET);
						scanf("%d", &conf);
						continue;}
					
					else { 	
   	   	    
	    			printf(YELLOW "\nQual Conjurador do seu adversário você quer atacar? " RESET);
	    			if(gamer == 1) {
						printf("(1-Gardel 2-Esdras)\n");
					}
					else {
						printf("(1-Edranyl 2-Alaric)\n");
					}
	    			
	    			scanf("%d", &maoDefesa);
					int maoDefesacor = maoDefesa - 1;
	    			fflush(stdin);
	    			
	    					if (maoDefesacor < 0 || maoDefesacor > 1 || (gamer == 1 && j2[maoDefesacor] == 5) || (gamer == 2 && j1[maoDefesacor] == 5)) {
	    						printf(YELLOW "Personagem inválido! Escolha um conjurador que ainda esteja batalhando.\n\n Insira qualquer valor para continuar. \n" RESET);
	    						scanf("%d", &conf);
								continue;}
	    					else {	   	
    		
	    		
									if (gamer == 1) {//SE FOR JOGADOR 1
	    									j2[maoDefesacor] = j1[maoAttackcor] + j2[maoDefesacor];
									} 
									else { // SE FOR JOGADOR 2
	    									j1[maoDefesacor] = j2[maoAttackcor] + j1[maoDefesacor];
									}	
		 		 		 		
	    		
							}			
					} 
			} 
			else if (acao == 2) { // SE AÇÃO FOR SOCORRER
				printf(YELLOW "Você escolheu SOCORRER.\n" RESET);
			
				if (gamer == 1) {
					if ((j1[0]+j1[1]) % 2 == 0 && !(j1[0] == j1[1]) && j1[0] != 5 && j1[1] != 5){
						j1[0] = j1[1] = (j1[0]+j1[1])/2;
	  	  	  	    }	
				
					else{
					
						if (j1[1] == 5 && j1[0] % 2 == 0 ){
							j1[1] = 0;
							j1[0] = j1[1] = (j1[0]+j1[1])/2; 	
						
						}
					
						else if(j1[0] == 5 && j1[1] % 2 == 0 ) {
							j1[0] = 0	;
							j1[1] = j1[0] = (j1[0]+j1[1]/2)	;
						}
					
						else{
							printf(YELLOW "Operação inválida.\n\n Insira qualquer valor para continuar.\n" RESET);
							scanf("%d", &conf);
							continue;
						}
					}
				}
			 
				
				
				if (gamer == 2) {
					if ((j2[0]+j2[1]) % 2 == 0 && !(j2[0] == j2[1]) && j2[0] !=5 && j2[1] !=5){
						j2[0] = j2[1] = (j2[0]+j2[1])/2;
					}
				
					else{
					
						if (j2[1] == 5 && j2[0] % 2 == 0 ){
							j2[1] = 0;
							j2[0] = j2[1] = (j2[0]+j2[1])/2; 	
						
						}
					
						else if(j2[0] == 5 && j2[1] % 2 == 0 ) {
							j2[0] = 0;
							j2[1] = j2[0] = (j2[0]+j2[1])/2;
						}
						
						else if(j2[0] == j2[1]) {
							printf(YELLOW "Operação inválida\n\n Insira qualquer valor para continuar.\n" RESET);
							scanf("%d", &conf);
							continue;
							
						}
				
				
						else {
							printf(YELLOW "Operação inválida\n\n Insira qualquer valor para continuar.\n" RESET);
							scanf("%d", &conf);
							continue;
				
							}
		 		    }		
				}
			}
			
			
			else if (acao == 0) {
				system("cls");
				printf(BEGE"\n======================================================================================================\n" RESET);
				printf(YELLOW"                                    OBRIGADO POR JOGAR!\n"RESET);
				printf(BEGE"======================================================================================================\n" RESET);
				return 0;
			}
			
			else if (acao != (acao >= 0 && acao <= 2) ){ 
							system("cls");
				printf("\nBoa tentativa.\n 1-Desculpa\n 2-Perdão\n");
				scanf("%d", &egua);
				continue;
			}
			
			// ALTERA A VARIAVEL GAMER PARA 1 OU 2 NO FINAL DA JOGADA
			gamer = (gamer == 1) ? 2 : 1;
				
			} 
		
		// FIM DO JOGO ========================================================================================
		
			system("cls");
			
			printf(BEGE "======================================================================================================\n" RESET);
			printf(RED"FEITICEIROS:\t\t"RESET);
	    	
			if (j1[0] < 5) {
				printf("Edranyl:");
				printf(CYAN " %d° Ciclo de Mana\t\t" RESET, j1[0]);
			} 
			else if (j1[0] > 5){
				j1[0] -= 5;
				printf( "Edranyl:"); 
				printf(CYAN " %d° Ciclo de Mana\t\t" RESET , j1[0]);
			} 
			else {	
				printf(MAGENTA "Edranyl Paralisado\t\t\t" RESET);    	
			}
			//====================================
			if (j1[1] < 5) {
				printf("Alaric:\t");
				printf (CYAN "%d° Ciclo de Mana\t\t\n" RESET, j1[1]);
			}
			else if (j1[1] > 5) {
				j1[1] -= 5;
				printf("Alaric:\t");
				printf(CYAN"%d° Ciclo de Mana\t\t\n" RESET, j1[1]);
			}
			else {
				printf(MAGENTA "Alaric\tParalisado\t\t\n" RESET); 
			}   	
			//===================================
			printf(BEGE "======================================================================================================\n" RESET);
	    	printf(BLUE "MAGOS:\t\t\t" RESET);
	    	
			if (j2[0] < 5) { 
				printf("Gardel:\t");
				printf(CYAN " %d° Ciclo de Mana \t\t" RESET, j2[0]);
			}
	 		else if (j2[0] > 5) {
				j2[0] -= 5;
				printf("Gardel:\t");
				printf(CYAN " %d° Ciclo de Mana(s)\t\t" RESET, j2[0]);
			}
			 else {
			  printf(MAGENTA "Gardel\t Paralisado\t\t\t" RESET);
			}  
			//====================================  	
	    	
			if (j2[1] < 5) { 
				 printf("Esdras:\t"); 
				 printf(CYAN "%d° Ciclo de Mana\t\t\n" RESET, j2[1]);
			}
			else if (j2[1] > 5){
				 	j2[1] -= 5;
				printf("Esdras:\t");
				printf(CYAN "%d° Ciclo de Mana\t\t\n" RESET, j2[1]);
			}
			else {	
			  printf(MAGENTA"Esdras\tParalisado\t\t\n" RESET);
			}  
			//====================================
			printf(BEGE "======================================================================================================\n\n" RESET);
			
			if (j1[0] <5 || j1[1] < 5){
				printf(YELLOW"Jogador 1 foi o vencedor!\n "RESET);
				printf(RED"\n======================================================================================================\n"RESET);
				printf(YELLOW"                                    VITÓRIA DOS FEITICEIROS!\n"RESET);
				printf(RED"======================================================================================================\n"RESET);
			}
			if(j2[0] <5 || j2[1] < 5){
				printf(YELLOW "Jogador 2 foi o vencedor!\n" RESET);
				printf(BLUE"\n======================================================================================================\n"RESET);
				printf(YELLOW"                                    VITÓRIA DOS MAGOS!\n");
				printf(BLUE"======================================================================================================\n"RESET);
			}
				printf("1-Revanche\n2-Retornar ao Menu\n");
				scanf("%d", &ordem);
	} while (ordem == 1);				
	
				

		
   	   //============================================================================================	
}
